<h1>Property Dashboard</h1>

<p>Portfolio value: {{portfolio_value}}</p>

{{outstanding_mortgages}}

{{ltv}}

{{current_gross_yield}}

{{potential_gross_yield}}

{{rate_of_return}}

{{doubling_period}}

<p>Total income - Â£{{potential_rents}}</p>

<p>You could be earning {{difference_in_rent}} more in rent a year</p>

<a href="/">all</a>
<a href="?city=liverpool">liverpool</a>
<a href="?city=manchester">manchester</a>

<div class="properties">
{% for property in properties %}
<section>
    <a href="/{{ property.id }}">
        {% if property.photo %}
        <img src="/media/{{ property.photo }}" alt="" width="300" />
        {% endif %}

        <p>{{property.address}} - {{property.value}} - {{property.city}} - {{property.mortgage_deal_expiry_date}}</p>
    </a>
</section>
{% endfor %}
</div>

<style>
    .properties {
        display: flex;
        align-items: baseline;
        flex-flow: wrap;
        justify-content: space-between;
    }
</style>

<script
  src="https://code.jquery.com/jquery-3.7.0.slim.min.js"
  integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE="
  crossorigin="anonymous"></script>

<script>
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    fetch("/api", {
        method: "get",
        credentials: "same-origin",
        headers: {
            "X-CSRFToken": getCookie("csrftoken"),
            "Accept": "application/json",
            "Content-Type": "application/json"
        },
    }).then(function(response) {
        return response.json();
    }).then(function(data) {
        console.log("Data is ok", data);
    }).catch(function(ex) {
        console.log("parsing failed", ex);
    });
</script>